<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Device Features Example</title>
<style>
  body { font-family: Arial, sans-serif; }
  .section { margin-bottom: 20px; margin-top: 10px;}
</style>
</head>
<body>
<h1>디바이스 기능 테스트</h1>

<div class="section" id="audio-recording">
  <h2>녹음</h2>
  <button id="startRecording">녹음 시작</button>
  <button id="stopRecording" disabled>녹음 중지</button>
  <p>녹음 상태: <span id="recordingStatus">중지됨</span></p>
  <p id="transcriptionText"></p>
</div>

<div class="section" id="geolocation">
  <h2>위치 정보</h2>
  <button id="getLocation">현재 위치 가져오기</button>
  <p>위도: <span id="latitude">-</span>, 정확도: <span id="latitudeAccuracy">-</span></p>
  <p>경도: <span id="longitude">-</span>, 정확도: <span id="longitudeAccuracy">-</span></p>
  <p>고도: <span id="altitude">-</span>, 고도 정확도: <span id="altitudeAccuracy">-</span></p>
  <p>이동 방향: <span id="heading">-</span></p>
  <p>속도: <span id="speed">-</span></p>
</div>

<div class="section" id="motion">
  <h2>모션 데이터</h2>
  <button id="startMotion">모션 데이터 수집 시작</button>
  <p>Alpha (장치가 z축을 중심으로 회전한 각도): <span id="alpha">0</span></p>
  <p>Beta (장치가 x축을 중심으로 전후로 기울어진 각도): <span id="beta">0</span></p>
  <p>Gamma (장치가 y축을 중심으로 좌우로 기울어진 각도): <span id="gamma">0</span></p>
</div>

<div class="section" id="device-motion">
    <h2>장치 모션 데이터</h2>
    <button id="startDeviceMotion">모션 데이터 수집 시작</button>
    <p>가속도: <span id="acceleration">대기 중...</span></p>
    <p>중력 포함 가속도: <span id="accelerationGravity">대기 중...</span></p>
    <p>회전율: <span id="rotationRate">대기 중...</span></p>
    <p>데이터 측정 간격: <span id="interval">대기 중...</span></p>
</div>
  

<script>
// 녹음 기능
let mediaRecorder;
let audioChunks = [];

document.getElementById('startRecording').onclick = async () => {
  if (!navigator.mediaDevices) {
    alert('미디어 장치 접근 불가능');
    return;
  }
  const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
  mediaRecorder = new MediaRecorder(stream);
  mediaRecorder.start();
  document.getElementById('recordingStatus').textContent = '녹음 중';
  document.getElementById('stopRecording').disabled = false;
  document.getElementById('startRecording').disabled = true;

  mediaRecorder.ondataavailable = event => {
    audioChunks.push(event.data);
  };
  
  mediaRecorder.onstop = async () => {
    // 녹음이 중지되면, audioChunks에서 오디오 파일 생성
    const audioBlob = new Blob(audioChunks, { type: 'audio/wav' });
    audioChunks = []; // 초기화
    const audioUrl = URL.createObjectURL(audioBlob);
    // 오디오 파일을 재생하거나 다운로드할 수 있습니다
    // 예: 오디오를 재생하기 위한 새로운 오디오 요소를 만들고 문서에 추가
    const audioElement = document.createElement('audio');
    audioElement.src = audioUrl;
    audioElement.controls = true;
    document.body.appendChild(audioElement);
  };
};

document.getElementById('stopRecording').onclick = () => {
  mediaRecorder.stop();
  document.getElementById('recordingStatus').textContent = '중지됨';
  document.getElementById('stopRecording').disabled = true;
  document.getElementById('startRecording').disabled = false;
  // 녹음된 오디오를 텍스트로 변환하는 예시 메시지입니다.
  document.getElementById('transcriptionText').textContent = '녹음된 오디오를 텍스트로 변환하는 예시 메시지입니다.';
};

// 위치 정보 기능
document.getElementById('getLocation').onclick = () => {
  if (!navigator.geolocation) {
    alert('Geolocation API 접근 불가능');
    return;
  }
  navigator.geolocation.getCurrentPosition(position => {
    document.getElementById('latitude').textContent = position.coords.latitude.toFixed(2);
    document.getElementById('longitude').textContent = position.coords.longitude.toFixed(2);
    document.getElementById('latitudeAccuracy').textContent = position.coords.accuracy + 'm';
    document.getElementById('longitudeAccuracy').textContent = position.coords.accuracy + 'm';
    document.getElementById('altitude').textContent = position.coords.altitude ? position.coords.altitude.toFixed(2) + 'm' : 'N/A';
    document.getElementById('altitudeAccuracy').textContent = position.coords.altitudeAccuracy ? position.coords.altitudeAccuracy.toFixed(2) + 'm' : 'N/A';
    document.getElementById('heading').textContent = position.coords.heading !== null ? position.coords.heading.toFixed(2) : 'N/A';
    document.getElementById('speed').textContent = position.coords.speed !== null ? position.coords.speed.toFixed(2) + 'm/s' : 'N/A';
  }, (err) => {
    console.error(err);
    alert('위치 정보를 가져오는 데 실패했습니다.');
  });
};

// 모션 데이터 기능
document.getElementById('startMotion').onclick = () => {
  if (window.DeviceOrientationEvent) {
    window.addEventListener('deviceorientation', event => {
      document.getElementById('alpha').textContent = event.alpha.toFixed(2);
      document.getElementById('beta').textContent = event.beta.toFixed(2);
      document.getElementById('gamma').textContent = event.gamma.toFixed(2);
    });
  } else {
    alert('Device Orientation API 접근 불가능');
  }
};

document.getElementById('startDeviceMotion').addEventListener('click', function() {
  if (window.DeviceMotionEvent) {
    window.addEventListener('devicemotion', function(event) {
      document.getElementById('acceleration').textContent = 
        `X: ${event.acceleration.x.toFixed(2)}, Y: ${event.acceleration.y.toFixed(2)}, Z: ${event.acceleration.z.toFixed(2)}`;
      document.getElementById('accelerationGravity').textContent = 
        `X: ${event.accelerationIncludingGravity.x.toFixed(2)}, Y: ${event.accelerationIncludingGravity.y.toFixed(2)}, Z: ${event.accelerationIncludingGravity.z.toFixed(2)}`;
      document.getElementById('rotationRate').textContent = 
        `α: ${event.rotationRate.alpha.toFixed(2)}, β: ${event.rotationRate.beta.toFixed(2)}, γ: ${event.rotationRate.gamma.toFixed(2)}`;
      document.getElementById('interval').textContent = 
        `${event.interval}ms`;
    });
  } else {
    alert('DeviceMotionEvent를 지원하지 않는 장치입니다.');
  }
});


</script>

<ul>
    <li><strong>document</strong>: 현재 창에 로드된 문서에 대한 참조를 제공합니다.</li>
    <li><strong>localStorage</strong>: 웹 스토리지 API의 일부로, 도메인과 브라우저 세션 간에 데이터를 저장합니다.</li>
    <li><strong>sessionStorage</strong>: 웹 스토리지 API의 일부로, 페이지 세션 동안 데이터를 저장합니다.</li>
    <li><strong>fetch</strong>: 네트워크 요청을 보내고 받을 수 있는 API를 제공합니다.</li>
    <li><strong>addEventListener</strong>: 지정된 이벤트가 대상에 전달될 때마다 호출할 함수를 설정합니다.</li>
    <li><strong>removeEventListener</strong>: addEventListener를 통해 추가된 이벤트 리스너를 제거합니다.</li>
    <li><strong>setTimeout</strong>: 일정 시간이 지난 후 함수를 실행합니다.</li>
    <li><strong>clearTimeout</strong>: setTimeout에 의해 설정된 타이머를 취소합니다.</li>
    <li><strong>setInterval</strong>: 지정된 시간 간격으로 함수를 반복 실행합니다.</li>
    <li><strong>clearInterval</strong>: setInterval에 의해 설정된 반복 타이머를 취소합니다.</li>
    <li><strong>location</strong>: 현재 창의 위치(URL)을 나타내며, URL을 변경하거나 새 페이지로 리다이렉트할 때 사용할 수 있습니다.</li>
    <li><strong>history</strong>: 브라우저 세션 내에서 사용자의 탐색 기록을 다룹니다.</li>
    <li><strong>screen</strong>: 사용자의 화면에 대한 정보를 제공합니다(예: 해상도).</li>
    <li><strong>navigator</strong>: 현재 웹 브라우저의 정보를 제공하며, 사용자의 장치, 네트워크 상태, 선호 언어 등에 대한 정보를 포함합니다.</li>
    <li><strong>performance</strong>: 현재 페이지에 대한 성능 관련 정보와 도구를 제공합니다.</li>
    <li><strong>requestAnimationFrame</strong>: 애니메이션을 위해 다음 리페인트 전에 실행할 콜백 함수를 요청합니다.</li>
    <li><strong>cancelAnimationFrame</strong>: requestAnimationFrame에 의해 예약된 애니메이션 프레임 요청을 취소합니다.</li>
    <li><strong>Alert, Confirm, Prompt</strong>: 사용자에게 각각 알림, 확인/취소, 입력을 요구하는 대화상자를 표시합니다.</li>
    <li><strong>DeviceOrientationEvent, DeviceMotionEvent</strong>: 장치의 방향이나 움직임을 감지하는 이벤트입니다.</li>
  </ul>

  
</body>
</html>
